
Iservices.neo4j_service.Neo4jGraphRAGService.analyze_control_effectivenessA
5/home/omar/Documents/ruleIQ/services/neo4j_service.pyƒ ƒ(+"2*×

2
„ „(A
Š

… —(
query"__id*ì

__unknown_file (ÏÌ
É
        MATCH (ctrl:Control)
        OPTIONAL MATCH (ctrl)-[impl:IMPLEMENTS]->(req:Requirement)
        OPTIONAL MATCH (ctrl)-[mit:MITIGATES]->(risk:Risk)
        OPTIONAL MATCH (metric:Metric)-[:MEASURES]->(ctrl)
        RETURN ctrl.name AS control,
               ctrl.automation_level AS automation,
               ctrl.implementation_status AS status,
               COUNT(DISTINCT req) AS requirements_addressed,
               COUNT(DISTINCT risk) AS risks_mitigated,
               COLLECT(DISTINCT metric.name) AS metrics,
               CASE ctrl.automation_level
                 WHEN 'FULLY_AUTOMATED' THEN 3
                 WHEN 'SEMI_AUTOMATED' THEN 2
                 WHEN 'MANUAL' THEN 1
                 ELSE 0
               END AS automation_score
        ORDER BY COUNT(DISTINCT req) DESC, automation_score DESC
        ˜•

˜ ˜(1
%1*K

__unknown_file (/-
+services.neo4j_service.Neo4jGraphRAGService*%

__unknown_file (	

query2execute_queryC
A

˜ ˜(1	
results"__id*"

__unknown_file (

%1

™ ™(1
%2"dict£
 

™ ™(0
%3"__mapSet*"

__unknown_file (

%2*5

__unknown_file (
control_effectiveness*'

__unknown_file (
	
results"

™ ™(1

%2B/-
+services.neo4j_service.Neo4jGraphRAGServiceH