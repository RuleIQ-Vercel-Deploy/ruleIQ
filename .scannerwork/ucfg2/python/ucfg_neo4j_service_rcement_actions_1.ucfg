
Aneo4j_service.Neo4jGraphRAGService.learn_from_enforcement_actionsM
A/home/omar/Documents/ruleIQ/langgraph_agent/core/neo4j_service.py´ ´(,"2*†
2
¨ ¨(6·
ﬁ

≠ ∏(
query"__id*¿

__unknown_file (£†
ù
        MATCH (ea:EnforcementAction)-[:PRECEDENT_FOR]->(ctrl:Control)
        OPTIONAL MATCH (ctrl)-[:IMPLEMENTS]->(req:Requirement)
        RETURN ea.target_company AS company,
               ea.violation_type AS violation,
               ea.penalty_amount AS fine,
               ea.lessons_learned AS lessons,
               ea.date AS incident_date,
               COLLECT(DISTINCT ctrl.name) AS controls_to_strengthen,
               COLLECT(DISTINCT req.title) AS requirements_affected
        ORDER BY ea.penalty_amount DESC
        èå

π π(1
%1*B

__unknown_file (&$
"neo4j_service.Neo4jGraphRAGService*%

__unknown_file (	

query2execute_queryC
A

π π(1	
results"__id*"

__unknown_file (

%1

∫ ∫(/
%2"dict°
û

∫ ∫(.
%3"__mapSet*"

__unknown_file (

%2*3

__unknown_file (
enforcement_lessons*'

__unknown_file (
	
results"

∫ ∫(/

%2B&$
"neo4j_service.Neo4jGraphRAGServiceH