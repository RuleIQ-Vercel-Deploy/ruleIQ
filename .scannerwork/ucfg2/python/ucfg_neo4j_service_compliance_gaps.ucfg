
@services.neo4j_service.Neo4jGraphRAGService.find_compliance_gapsA
5/home/omar/Documents/ruleIQ/services/neo4j_service.pyÂ Â(""2*Å
2
Ê Ê(<Ω
∫

Ë Û(
query"__id*ú

__unknown_file (ˇ¸
˘
        MATCH (domain:ComplianceDomain)-[:GOVERNS]->(reg:Regulation)
              -[:REQUIRES]->(req:Requirement)
        WHERE NOT EXISTS((req)<-[:IMPLEMENTS]-(:Control))
          AND req.mandatory = true
        RETURN domain.name AS domain,
               domain.priority AS priority,
               reg.name AS regulation,
               COUNT(req) AS missing_controls,
               COLLECT(req.title) AS unimplemented_requirements
        ORDER BY domain.priority, missing_controls DESC
        òï

ı ı(1
%1*K

__unknown_file (/-
+services.neo4j_service.Neo4jGraphRAGService*%

__unknown_file (	

query2execute_queryC
A

ı ı(1	
results"__id*"

__unknown_file (

%1

ˆ ˆ(+
%2"dictù
ö

ˆ ˆ(*
%3"__mapSet*"

__unknown_file (

%2*/

__unknown_file (
compliance_gaps*'

__unknown_file (
	
results"

ˆ ˆ(+

%2B/-
+services.neo4j_service.Neo4jGraphRAGServiceH