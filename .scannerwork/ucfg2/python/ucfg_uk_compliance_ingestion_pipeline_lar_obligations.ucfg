
Puk_compliance_ingestion_pipeline.UKComplianceGraphQuery.find_similar_obligations_
S/home/omar/Documents/ruleIQ/services/compliance/uk_compliance_ingestion_pipeline.py… …(&"2*¶
2
Ã Ã(TÄ
~

Õ Õ(
%20"__id*c

__unknown_file (G*E9
7uk_compliance_ingestion_pipeline.UKComplianceGraphQuery"
driverCA

Õ Õ((
%21*#

__unknown_file (

%202sessionD
B

Õ Õ(3	
session"__id*#

__unknown_file (

%21*
3
11*K
3%
#uk_compliance_ingestion_pipeline.py"
É É(
implicit return**
4
Å Å("

Å Å(
	
records*⁄
6
˙ ˇ(

˚ ˛(
%1"dict

¸* ¸(<
%2"dictwu

¸/ ¸(;
%3"__mapGet*&

__unknown_file (


record*"

__unknown_file (
o22__getitem__k
i

¸* ¸(<
%4"dict.__init__*"

__unknown_file (

%2*"

__unknown_file (

%3ì
ê

¸ ¸(<
%5"__mapSet*"

__unknown_file (

%1**

__unknown_file (

obligation*"

__unknown_file (

%2}

˝* ˝(>
%6"__mapGet*&

__unknown_file (


record**

__unknown_file (

similarity2__getitem__ì
ê

˝ ˝(>
%7"__mapSet*"

__unknown_file (

%1**

__unknown_file (

similarity*"

__unknown_file (

%6vt

˙ ˇ(
%8"list.append*'

__unknown_file (
	
records*"

__unknown_file (

%12append*
4
6*µ
7
Ï ˜(◊‘

Ï ˜(
%9*'

__unknown_file (
	
session*·

__unknown_file (ƒ¡
æ
                    MATCH (o1:Obligation {id: $ob_id})
                    MATCH (o2:Obligation)
                    WHERE o2.id <> o1.id
                    AND o2.description CONTAINS substring(o1.description, 0, 20)
                    RETURN o2, 0.5 as similarity
                    LIMIT $limit
                2run:
ob_id

obligation_id:
limit	

limitB
@

Ï ˜(
result"__id*"

__unknown_file (

%9*
4
6*Ô
10
„ Ë(

‰ Á(
%10"dict

Â& Â(8
%11"dictxv

Â+ Â(7
%12"__mapGet*&

__unknown_file (


record*"

__unknown_file (
o22__getitem__n
l

Â& Â(8
%13"dict.__init__*#

__unknown_file (

%11*#

__unknown_file (

%12ñ
ì

Â Â(8
%14"__mapSet*#

__unknown_file (

%10**

__unknown_file (

obligation*#

__unknown_file (

%11Ä~

Ê& Ê(:
%15"__mapGet*&

__unknown_file (


record**

__unknown_file (

similarity2__getitem__ñ
ì

Ê Ê(:
%16"__mapSet*#

__unknown_file (

%10**

__unknown_file (

similarity*#

__unknown_file (

%15xv

„ Ë(
%17"list.append*'

__unknown_file (
	
records*#

__unknown_file (

%102append*

4
7
10*æ
11
– ﬂ(˜Ù

– ﬂ(
%18*'

__unknown_file (
	
session*Ä

__unknown_file („‡
›
                MATCH (o1:Obligation {id: $ob_id})
                WHERE o1.embedding IS NOT NULL
                MATCH (o2:Obligation)
                WHERE o2.id <> o1.id AND o2.embedding IS NOT NULL
                WITH o1, o2, 
                     gds.similarity.cosine(o1.embedding, o2.embedding) as similarity
                WHERE similarity > 0.7
                RETURN o2, similarity
                ORDER BY similarity DESC
                LIMIT $limit
            2run:
ob_id

obligation_id:
limit	

limitC
A

– ﬂ(
result"__id*#

__unknown_file (

%18

· ·(
%19"listD
B

· ·(	
records"__id*#

__unknown_file (

%19*

4
7
10:

   ( 
obligation_id:

 "  (0
limitB;9
7uk_compliance_ingestion_pipeline.UKComplianceGraphQueryH