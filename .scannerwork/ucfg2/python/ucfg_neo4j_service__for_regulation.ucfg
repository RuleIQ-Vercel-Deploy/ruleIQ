
Iservices.neo4j_service.Neo4jGraphRAGService.query_controls_for_regulationA
5/home/omar/Documents/ruleIQ/services/neo4j_service.pyÍ Í(+"2*–

2
Î Î(P¨
¥

Ð Û(
query"__id*‡

__unknown_file (êç
ä
        MATCH (reg:Regulation {name: $regulation})-[:REQUIRES]->(req:Requirement)
        OPTIONAL MATCH (req)<-[:IMPLEMENTS]-(ctrl:Control)
        RETURN req.title AS requirement,
               req.mandatory AS is_mandatory,
               COLLECT(ctrl.name) AS existing_controls,
               CASE 
                 WHEN SIZE(COLLECT(ctrl)) = 0 THEN 'MISSING'
                 ELSE 'IMPLEMENTED'
               END AS status
        ORDER BY req.mandatory DESC, status
        

Ý Ý(+
%1"dict›
˜

Ý Ý(*
%2"__mapSet*"

__unknown_file (

%1**

__unknown_file (

regulation**

__unknown_file (


regulationB
@

Ý Ý(+
params"__id*"

__unknown_file (

%1À½

Þ Þ(9
%3*K

__unknown_file (/-
+services.neo4j_service.Neo4jGraphRAGService*%

__unknown_file (	

query*&

__unknown_file (


params2execute_queryC
A

Þ Þ(9	
results"__id*"

__unknown_file (

%3

ß ß(/
%4"dict¡
ž

ß ß(.
%5"__mapSet*"

__unknown_file (

%4*3

__unknown_file (
regulation_controls*'

__unknown_file (
	
results"

ß ß(/

%4:

Í2 Í(A

regulationB/-
+services.neo4j_service.Neo4jGraphRAGServiceH