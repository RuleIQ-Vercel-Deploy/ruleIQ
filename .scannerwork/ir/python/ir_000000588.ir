
©Ÿ"
        MATCH (ea:EnforcementAction)-[:PRECEDENT_FOR]->(ctrl:Control)
        OPTIONAL MATCH (ctrl)-[:IMPLEMENTS]->(req:Requirement)
        RETURN ea.target_company AS company,
               ea.violation_type AS violation,
               ea.penalty_amount AS fine,
               ea.lessons_learned AS lessons,
               ea.date AS incident_date,
               COLLECT(DISTINCT ctrl.name) AS controls_to_strengthen,
               COLLECT(DISTINCT req.title) AS requirements_affected
        ORDER BY ea.penalty_amount DESC
        "str
3*"Extract lessons from enforcement actions"str
"enforcement_lessons"strself
ƒ- ƒ(1"Û(
&
† †(³query"#id#:Bstr#
!

“ “(1"#unknown-value#,
*

“ “(1results"#unknown-value#&
$

” ”(/"#new-object#Bdict"
 

” ”(.	"	#map-set#:

” ”(/*5/home/omar/Documents/ruleIQ/services/neo4j_service.py